<!-- Hero Carousel with two-column layout -->
<section class="hero-carousel">
  <div class="slides">
    {% for block in section.blocks %}
    <div class="slide">
      <div class="hero-principal">
        <div class="hero-left">
          {% if block.settings.imagen != blank %}
          <div class="hero-img-wrapper">
            {% if block.settings.enlace_imagen != blank %}
            <a href="{{ block.settings.enlace_imagen }}">
              {{ block.settings.imagen | image_url: width: 1200 | image_tag:
                class: 'hero-img',
                loading: 'lazy',
                alt: 'Slide banner',
                widths: '375, 550, 750, 1200',
                width: 1200 }}
            </a>
            {% else %}
            {{ block.settings.imagen | image_url: width: 1200 | image_tag:
              class: 'hero-img',
              loading: 'lazy',
              alt: 'Slide banner',
              widths: '375, 550, 750, 1200',
              width: 1200 }}
            {% endif %}
            {% if block.settings.variant_id != blank %}
            <button class="cta-ajustada add-to-cart" data-variant-id="{{ block.settings.variant_id }}">
              <span class="cta-texto">üõí Agregar al carrito</span>
              <span class="cta-icono-mobile">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1
                  0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.2
                  10l.94 2h8.72c.75 0 1.41-.41 1.75-1.03L21 6H5.21l-.94-2H1v2h2l3.6
                  7.59-1.35 2.45C4.52 16.37 5.48 18 7 18h12v-2H7.42c-.14
                  0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c1.17 0 2.18-.76
                  2.55-1.84l3.58-6.49-.03-.01H5.21z"/>
                </svg>
                <svg viewBox="0 0 24 24" width="20" height="20" fill="white" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19 13H13v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
              </span>
            </button>
            {% endif %}
          </div>
          {% endif %}
        </div>
        <div class="hero-right">
          {% if block.settings.imagen_secundaria_1 != blank %}
          <div class="small-banner">
            {% if block.settings.enlace_imagen_secundaria_1 != blank %}
            <a href="{{ block.settings.enlace_imagen_secundaria_1 }}">
              {{ block.settings.imagen_secundaria_1 | image_url: width: 600 | image_tag:
                class: 'hero-img',
                loading: 'lazy',
                alt: 'Banner secundario superior',
                widths: '375, 550, 750',
                width: 600 }}
            </a>
            {% else %}
              {{ block.settings.imagen_secundaria_1 | image_url: width: 600 | image_tag:
                class: 'hero-img',
                loading: 'lazy',
                alt: 'Banner secundario superior',
                widths: '375, 550, 750',
                width: 600 }}
            {% endif %}
          </div>
          {% endif %}
          {% if block.settings.imagen_secundaria_2 != blank %}
          <div class="small-banner">
            {% if block.settings.enlace_imagen_secundaria_2 != blank %}
            <a href="{{ block.settings.enlace_imagen_secundaria_2 }}">
              {{ block.settings.imagen_secundaria_2 | image_url: width: 600 | image_tag:
                class: 'hero-img',
                loading: 'lazy',
                alt: 'Banner secundario inferior',
                widths: '375, 550, 750',
                width: 600 }}
            </a>
            {% else %}
              {{ block.settings.imagen_secundaria_2 | image_url: width: 600 | image_tag:
                class: 'hero-img',
                loading: 'lazy',
                alt: 'Banner secundario inferior',
                widths: '375, 550, 750',
                width: 600 }}
            {% endif %}
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  <button class="prev">‚ùÆ</button>
  <button class="next">‚ùØ</button>
</section>

<style>
.hero-carousel {
  position: relative;
  overflow: hidden;
  margin-top: 5px;
  margin-bottom: 5px;
}
.slides {
  display: flex;
  transition: transform 0.5s ease;
}
.slide {
  min-width: 100%;
  box-sizing: border-box;
}
.hero-principal {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 5px;
  align-items: stretch;
  text-align: center;
  background: #ffffff;
  border-radius: 16px;
  overflow: hidden;
  padding: 5px;
}
.hero-left {
  position: relative;
}
.hero-right {
  display: grid;
  grid-template-rows: 1fr 1fr;
  gap: 10px;
  padding: var(--secondary-gap, 0);
}
.hero-img-wrapper {
  position: relative;
  width: 100%;
  height: 100%;
  max-width: none;
  margin: 0;
}
.hero-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 10px;
  display: block;
}
.small-banner .hero-img {
  border-radius: 10px;
}
.cta-ajustada {
  position: absolute;
  bottom: 20px;
  right: 20px;
  background-color: #30429a;
  color: white;
  padding: 12px 28px;
  border-radius: 30px;
  font-weight: 600;
  font-size: 16px;
  border: none;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transition: background-color 0.3s ease, transform 0.3s ease;
  z-index: 2;
  display: flex;
  align-items: center;
  gap: 8px;
  animation: bounceBtn 1.5s infinite;
}
.cta-ajustada:hover {
  background-color: #1f2a73;
  transform: scale(1.05);
}
@keyframes bounceBtn {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-8px);
  }
  60% {
    transform: translateY(-4px);
  }
}
.cta-icono-mobile {
  display: none;
  gap: 4px;
}
.cta-icono-mobile svg {
  vertical-align: middle;
}
.prev,
.next {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  font-size: 30px;
  color: #b3b3b3;
  cursor: pointer;
  padding: 0 10px;
  z-index: 1;
}
.prev {
  left: 10px;
}
.next {
  right: 10px;
}
@media screen and (min-width: 768px) {
  .hero-principal {
    padding: 40px 60px;
    gap: 10px;
  }
}
@media screen and (max-width: 767px) {
  .hero-principal {
    display: flex;
    flex-direction: column;
  }
  .hero-right {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 5px;
    padding: var(--secondary-gap-mobile, 0);
  }
  .small-banner + .small-banner {
    margin-top: 0;
  }
  .cta-ajustada {
    font-size: 0;
    padding: 12px;
    bottom: 14px;
    right: 14px;
    border-radius: 50%;
    width: 52px;
    height: 52px;
    justify-content: center;
    background-color: #30429a;
  }
  .cta-texto {
    display: none;
  }
  .cta-icono-mobile {
    display: inline-flex;
  }
}
/* Toast styles */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #333;
  color: #fff;
  padding: 12px 20px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 1000;
}
.toast.show {
  opacity: 1;
  pointer-events: auto;
}
.toast svg {
  fill: #4caf50;
}
</style>

<div class="toast" id="toast-message">
  <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M9 16.17l-3.88-3.88-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
  </svg>
  <span>Producto agregado al carrito</span>
</div>

<script>
(function() {
  var index = 0;
  var slides = document.querySelector('.slides');
  var total = slides.children.length;
  var toast = document.getElementById('toast-message');

  function showSlide(i) {
    index = (i + total) % total;
    slides.style.transform = 'translateX(' + (-index * 100) + '%)';
  }

  document.querySelector('.next').addEventListener('click', function() {
    showSlide(index + 1);
  });

  document.querySelector('.prev').addEventListener('click', function() {
    showSlide(index - 1);
  });

  setInterval(function() {
    showSlide(index + 1);
  }, 10000);

  function incrementCartBubble() {
    var bubble = document.querySelector('.cart-count-bubble');
    if (!bubble) return;
    var visible = bubble.querySelector('span[aria-hidden="true"]') || bubble;
    var hidden = bubble.querySelector('.visually-hidden');
    var count = parseInt(visible.textContent || '0', 10) + 1;
    visible.textContent = count;
    if (hidden) hidden.textContent = count;
    bubble.style.display = 'flex';
  }

  document.querySelectorAll('.add-to-cart').forEach(function(button) {
    button.addEventListener('click', function() {
      var variantId = this.getAttribute('data-variant-id');
      incrementCartBubble();
      fetch('/cart/add.js', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify({ id: variantId, quantity: 1 })
      })
      .then(response => response.json())
      .then(data => {
        updateCartBubble();
        showToast();
      })
      .catch(error => {
        console.error('Error al agregar al carrito:', error);
      });
    });
  });

  function showToast() {
    toast.classList.add('show');
    setTimeout(function() {
      toast.classList.remove('show');
    }, 3000);
  }

  function updateCartBubble() {
    fetch('/cart.js')
      .then(response => response.json())
      .then(data => {
        var bubble = document.querySelector('.cart-count-bubble');
        if (bubble) {
          var visible = bubble.querySelector('span[aria-hidden="true"]') || bubble;
          var hidden = bubble.querySelector('.visually-hidden');
          visible.textContent = data.item_count;
          if (hidden) hidden.textContent = data.item_count;
          bubble.style.display = data.item_count > 0 ? 'flex' : 'none';
        }
      });
  }
})();
</script>

{% schema %}
{
  "name": "Carrusel Hero Pro",
  "tag": "section",
  "class": "shopify-section--hero-carousel",
  "settings": [],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "imagen",
          "label": "Imagen del slide"
        },
        {
          "type": "url",
          "id": "enlace_imagen",
          "label": "Enlace al hacer clic en la imagen"
        },
        {
          "type": "text",
          "id": "variant_id",
          "label": "ID de la variante del producto"
        },
        {
          "type": "image_picker",
          "id": "imagen_secundaria_1",
          "label": "Banner secundario superior"
        },
        {
          "type": "url",
          "id": "enlace_imagen_secundaria_1",
          "label": "Enlace al hacer clic en el banner secundario superior"
        },
        {
          "type": "image_picker",
          "id": "imagen_secundaria_2",
          "label": "Banner secundario inferior"
        },
        {
          "type": "url",
          "id": "enlace_imagen_secundaria_2",
          "label": "Enlace al hacer clic en el banner secundario inferior"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Carrusel Hero Pro",
      "category": "Imagenes y contenido",
      "blocks": [
        { "type": "slide" },
        { "type": "slide" },
        { "type": "slide" }
      ]
    }
  ]
}
{% endschema %}
